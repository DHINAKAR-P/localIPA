/**
 *
 * @author Schubert Generated Code</br>
 * Date Created: </br>
 * @since  </br>
   build:   </p>
 *
 * code was generated by the Schubert System </br>
 * Schubert system Copyright - NewPortBay LLC copy_right_range</br>
 * The generated code is free to use by anyone</p>
 *
 *
 *
*/

app.controller('SurveyCtrl', [ '$scope', '$rootScope', '$location', '$window', '$q', '$http','surveyFactory','$cordovaSQLite','$timeout','$state','surveyService',function( $scope, $rootScope, $location, $window, $q, $http,surveyFactory,$cordovaSQLite,$timeout,$state,surveyService) {

		//alert('in controller');
		$scope.surveyId = 1;
		$scope.question = [{The_question: 'Loading..'}]
		$scope.imageURL = '';
				
		
		$scope.takePicture = function(){
			var cameraSuccess = function(imageData){
				 var image = document.getElementById('myImage');
				 image.src = imageData;
				 imageURL = "data:image/jpeg;charset=utf-8;base64," + imageData;
				// alert(imageData);
				console.log("Image data ==>"+imageData)				
			};
			var cameraError = function(){
				 // load some default image here
			};
		
			navigator.camera.getPicture(cameraSuccess, cameraError);
		};
		
		$scope.plain = false;
		$scope.isoption = false;
		$scope.yes_no = false;
		$scope.imageoption = false;
		
	$scope.getNextQuestion=function(){
		$scope.plain = false;
		$scope.isoption = false;
		$scope.yes_no = false;
		$scope.imageoption = false;
		
		$scope.options=[];
			surveyService.getNextQuestion($scope.surveyId,surveyFactory.getNextquestionId());
			$scope.question = surveyFactory.getQuestion();
			$scope.options = surveyFactory.getQuestionOptions();
			if($scope.options.length>0){
				if($scope.options[0].answer_type=='PLAIN_TEXT'){
					$scope.plain = true;	
				}else if($scope.options[0].answer_type=='OPTION_LABEL'){
					$scope.isoption = true;
				}else if($scope.options[0].answer_type=='YES_NO_CANCEL'){
					$scope.yes_no = true;
				}else if($scope.options[0].answer_type=='IMAGE_OPTIONS'){
					$scope.imageoption = true;
				}else{
				$scope.plain = false;
				$scope.isoption = false;
				$scope.yes_no = false;
				$scope.imageoption = false;
				}
			}
			console.log("nextquestion..........."+ $scope.options);
			$state.go("show-question");			
		
		}
		
		$scope.init=function(){
			// store all the questions in a list
			console.log('in init');
			surveyService.getAllQuestionsForASurvey($scope.surveyId);		
			
		}		
		$scope.init();
}]);


